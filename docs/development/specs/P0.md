# P0 Requirements (Must-Have / MVP)

These requirements MUST be met before any release.

---

## 1. Central Execution Mode (Default)

### 1.1 Workflow Integrity
- [~] `hub-run-all.yml` clones target repos (needs verification)
- [~] `hub-run-all.yml` runs Java CI for Java repos (needs verification)
- [~] `hub-run-all.yml` runs Python CI for Python repos (needs verification)
- [~] Workflow produces step summary with metrics table (needs verification)
- [~] Artifacts uploaded (coverage, reports) (needs verification)

### 1.2 Config System
- [~] `config/defaults.yaml` defines all tool toggles (exists, needs audit)
- [~] `config/repos/<repo>.yaml` overrides work (needs verification)
- [~] Config hierarchy: repo > hub-repo > defaults (needs verification)
- [~] Schema validation fails fast on bad config (implemented in orchestrator load step; needs verification)
- [~] `load_config.py` validates against schema before merge (implemented; needs verification)

### 1.3 Tool Toggles (Boolean Flags)
- [~] Java: JaCoCo, Checkstyle, SpotBugs, PMD, OWASP, PITest toggles (in defaults.yaml, needs test)
- [~] Python: pytest, Ruff, Bandit, pip-audit, Black, mypy toggles (in defaults.yaml, needs test)
- [~] Toggles use `enabled: true/false` pattern (needs audit)
- [~] Thresholds configurable per tool (needs audit)

---

## 2. Distributed Execution Mode (Optional)

### 2.1 Dispatch Fixes (CRITICAL GAPS)
- [~] Pass computed inputs to `workflow_dispatch` (not just `triggered_by_hub`) (implemented, needs verification)
- [~] Honor `default_branch` per repo (not hardcoded `main`) (implemented, needs verification)
- [~] Add `permissions: actions: write, contents: read` block (implemented)
- [~] Fail workflow if dispatch fails (not fire-and-forget) (implemented, needs verification)
- [~] Capture run IDs from dispatch response (best-effort capture added)

### 2.2 Aggregation (CRITICAL GAPS)
- [~] Generate real `hub-report.json` with per-repo metrics (implemented; needs verification)
- [~] Pull artifacts from dispatched runs (not stub) (download ci-report when available; needs verification)
- [~] Roll up coverage, mutation, vulnerability counts (coverage/mutation rolled; vuln TBD)
- [~] Fail hub run if any downstream run fails (hub job now fails on missing/failed)
- [~] Handle missing/timeout runs gracefully (marks missing/failed; needs verification)

---

## 3. Documentation

### 3.1 Core Docs
- [x] `docs/guides/ONBOARDING.md` exists
- [x] `docs/development/research/RESEARCH_LOG.md` comprehensive (1700+ lines)
- [x] `docs/development/architecture/ARCHITECTURE_PLAN.md` with phases
- [x] `AGENTS.md` for AI context
- [x] `docs/development/specs/` folder with checklists
- [~] `docs/guides/WORKFLOWS.md` - each workflow documented (needs verification)
- [~] `docs/reference/CONFIG_REFERENCE.md` - field-by-field (filled; needs verification)
- [~] `docs/reference/TOOLS.md` - each tool documented (filled; needs verification)
- [~] `docs/guides/MODES.md` - central vs distributed explained (expanded; needs verification)

### 3.2 Templates
- [~] `templates/repo/.ci-hub.yml` - master template with comments (added, needs review)
- [~] `templates/hub/config/repos/repo-template.yaml` - hub-side template (added, needs review)
- [~] Templates are copy-paste ready (only change repo name)
- [~] Every toggle has inline comment explaining it

---

## 4. Smoke Test

- [x] Run hub against 2-3 fixture repos (Java + Python)
- [x] Verify pass/fail detection works
- [x] Verify artifacts generated
- [x] Verify step summary accurate

---

## Acceptance Criteria

**P0 is COMPLETE when:**
1. All checkboxes above are `[x]`
2. Central mode runs successfully on real repos
3. Dispatch mode passes inputs and fails on errors
4. Aggregation produces real JSON with metrics
5. Docs and templates exist and are usable

---

## Status Legend
- `[ ]` - Not started
- `[~]` - Exists but needs verification/testing
- `[x]` - Verified complete
- `[!]` - Blocked

**Last Updated:** 2025-12-14
**Status:** IN PROGRESS â€” Central mode exists but unverified; dispatch/aggregation gaps remain
